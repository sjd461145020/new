<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>表格</title>
</head>
<meta charset="UTF-8">
<title>Title</title>
<!-- 引入bootstrap的css -->
<link rel="stylesheet" th:href="@{/js/bootstrap/bootstrap3/css/bootstrap.css}">
<link rel="stylesheet" th:href="@{/js/bootstrap/bootstrap3/css/bootstrap-theme.css}">
<!-- 引入jquery的js -->
<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
<!-- 引入bootstrap的js -->
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap3/js/bootstrap.js}"></script>
<!-- 引入树的相关的css、js -->
<link rel="stylesheet" th:href="@{/js/bootstrap/bootstrap-treeview/bootstrap-treeview.min.css}">
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap-treeview/bootstrap-treeview.min.js}"></script>

<!-- 引入选项卡的相关的css、js -->
<link rel="stylesheet" th:href="@{/js/bootstrap/bootStrap-addTabs/bootstrap.addtabs.css}">
<script type="text/javascript" th:src="@{/js/bootstrap/bootStrap-addTabs/bootstrap.addtabs.min.js}"></script>

<!-- 引入boostrap的表格的css、js -->
<link rel="stylesheet" th:href="@{/js/bootstrap/bootstrap-table/bootstrap-table.css}">
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap-table/bootstrap-table.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap-table/locale/bootstrap-table-zh-CN.js}"></script>
<!-- 引入bootbox弹框的js -->
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap-bootbox/bootbox.js}"></script>
<!-- 引入uploadify图片的 js -->
<link rel="stylesheet" th:href="@{/js/uploadify/uploadify.css}">
<script type="text/javascript" th:src="@{/js/uploadify/jquery.uploadify.min.js}"></script>

<!-- 引入日期的 js -->
<link rel="stylesheet" th:href="@{/js/bootstrap/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css}">
<script type="text/javascript"
        th:src="@{/js/bootstrap/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js}"></script>
<script type="text/javascript"
        th:src="@{/js/bootstrap/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js}"></script>

<!-- 引入 Bootstrap 图片的 js -->
<link rel="stylesheet" th:href="@{/js/bootstrap/bootstrap-fileinput/css/fileinput.css}">
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap-fileinput/js/fileinput.js}"></script>
<script type="text/javascript" th:src="@{/js/bootstrap/bootstrap-fileinput/js/locales/zh.js}"></script>

</head>
<body>
<select class="form-control" id="zhiweiidaa">
    <option value="-1">选择</option>
    <option value="1">1职位</option>
    <option value="2">2职位</option>
    <option value="3">3职位</option>
</select><br>
<button onclick="tiaocha()" class="btn" type="button">搜索</button>
<button onclick="xinzheng()" class="btn" type="button">新增</button>
<table class="table" id="myTable"></table>
</body>
<script>
    $('#myTable').bootstrapTable({
        toolbar:'#toolbar',
        url:'getliebiao',//获取数据地址
        pagination:true, //是否展示分页
        pageList:[2, 4, 6, 8],//分页组件
        pageNumber:1,
        pageSize:2,//默认每页条数
        sidePagination:'server',//分页方式：client客户端分页，server服务端分页（*
        striped:true,
        queryParams:function(){
            var zhiweiidaa = $('#zhiweiidaa').val();
            var typemovieid = $('#typemovieid').val();
            var moviedate = $('#moviedate').val();
            var amoviedate = $('#amoviedate').val();
            return {
                page: this.pageNumber,
                rows: this.pageSize,
                bumenid:zhiweiidaa,
                typemovieid:typemovieid,
                moviedate:moviedate,
                amoviedate:amoviedate,
            };
        },
        columns:[
            {checkbox:true},
            {field:'id',title:'ID',align:'center',width:150},
            {field:'name',title:'电影名称',align:'center',width:150},
            {field:'mima',title:'密码',align:'center',width:150},
            {field:'zhiwei',title:'职位',align:'center',width:150},
            {field:'bumen',title:'部门',align:'center',width:150},
            {field:'price',title:'薪资',align:'center',width:150},
            {field:'zuoyouming',title:'座右铭',align:'center',width:150},
            {field:"tool",title:"操作",formatter:function(value,row,index){
                    str ="";
                    str += "<a href='javascript:pishan("+row.id+")'>删除</a>";
                    str += "<a href='javascript:huixian("+row.id+")'>修改</a>";
                    return str;
                }}
        ]
    });

    function pishan(id) {
        $.ajax({
            url:'delete',
            type:'delete',
            data:{id:id},
            success:function () {
                $('#myTable').bootstrapTable("refresh")
            }
        })
    }


    //add
    var res;
    function createAddContent(url){
        $.ajax({
            url:url,
            async:false,//同步
            success:function(data){
                res = data;
            }
        });
        return res;
    }
    function xinzheng(){
        bootbox.dialog({
            title:'新增用户',
            message: createAddContent("aaa/add"),
            closeButton: true,
            buttons : {
                "success" : {
                    "label" : "<i class='icon-ok'></i> 保存",
                    "className" : "btn-sm btn-success",
                    "callback" : function() {//回调函数
                        //提交表单
                        $.ajax({
                            url:"add",
                            type:'put',
                            data:$("#myForm").serialize(),//表单序列化
                            success:function(data){
                                //刷新表格
                                $('#myTable').bootstrapTable('refresh');
                            }
                        });
                    }
                },
                "cancel" : {
                    "label" : "<i class='icon-info'></i> 取消",
                    "className" : "btn-sm btn-danger"
                }
            }

        });
    }
    //huixian
    function huixian(id){
        bootbox.dialog({
            title:'修改用户',
            message: createAddContent("aaa/add"),
            closeButton: true,
            buttons : {
                "success" : {
                    "label" : "<i class='icon-ok'></i> 保存",
                    "className" : "btn-sm btn-success",
                    "callback" : function() {//回调函数
                        //提交表单
                        $.ajax({
                            url:"add",
                            type:'put',
                            data:$("#myForm").serialize(),//表单序列化
                            success:function(data){
                                //刷新表格
                                $('#myTable').bootstrapTable('refresh');
                            }
                        });
                    }
                },
                "cancel" : {
                    "label" : "<i class='icon-info'></i> 取消",
                    "className" : "btn-sm btn-danger"
                }
            }
        });
        $.ajax({
            url:"huixian",
            type:'get',
            data:{id:id},
            success:function(data){
                $("#id").val(data.id);
                $("#name").val(data.name);
                $("#mima").val(data.mima);
                $("#bumenid").val(data.bumenid);
                $("#zhiweiid").val(data.zhiweiid);
                $("#price").val(data.price);
                $("#zuoyouming").val(data.zuoyouming);
            }
        });
    }

    function tiaocha(){
        $('#myTable').bootstrapTable("refresh");
    }

</script>
</html>